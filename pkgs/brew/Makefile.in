# pkgs/brew/Makefile
#
# Make stuff for MacOS Homebrew package

VERSION =	@PACKAGE_VERSION@
BREWDIR =	/usr/local/Homebrew/Library/Taps/homebrew/homebrew-core/Formula

INSTALL =	@INSTALL@

all:
	@echo "Valid targets: 'create', 'install', 'distclean', 'clean', 'push' and 'pull'."
	@exit 1

create:
	brew create https://github.com/ptrrkssn/acltool/archive/v$(VERSION).tar.gz
	brew edit acltool


install: install-formulae
	(cd ../.. && $(MAKE) dist && \
	    cp acltool-$(VERSION).tar.gz `brew --cache acltool`) && \
	  (brew install acltool || brew upgrade acltool || brew reinstall acltool)

install-formulae: acltool.rb
	$(INSTALL) -m 0644 acltool.rb $(BREWDIR)


distclean: clean
	rm -f acltool.rb

clean:
	-rm -fr *~ \#* core


push: 	distclean
	git add -A && git commit -a && git push

pull:
	git pull

